package fr.utbm.ia54.simulationorca.sarlagent

import io.sarl.core.Initialize
import io.sarl.core.Lifecycle
import fr.utbm.ia54.simulationorca.framework.Position
import java.util.Collection
import fr.utbm.ia54.simulationorca.sarlevent.PerceptionReceivedEvent
import io.sarl.core.DefaultContextInteractions
import fr.utbm.ia54.simulationorca.sarlevent.InfuenceReceivedEvent
import io.sarl.util.Scopes

agent Pedestrian {

	uses Lifecycle, DefaultContextInteractions
	
	var initialPosition : Position
	var finalPostition : Position
	
	on Initialize {
		
		initialPosition = (occurrence.parameters.get(0) as Collection<Object>).get(0) as Position
		finalPostition = (occurrence.parameters.get(0) as Collection<Object>).get(0) as Position
		
	}
	
	on PerceptionReceivedEvent{
		println("in PerceptionReceivedEvent")
		//TODO use capacity ComputeNextMoveCapa
		var newPos : Position = new Position(3,3)
		
		/* 
		 * send his new position with event InfluenceReceivedEvent		
		 * scope send only to the source of PerceptionReceivedEvent, so Environment
		*/
		emit(new InfuenceReceivedEvent(newPos),Scopes.addresses(occurrence.source))
	}	
}